# E2E í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

Playwrightë¥¼ ì‚¬ìš©í•œ ì—”ë³´ì„ í”Œë˜ë„ˆ í”„ë¡œ E2E í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ì²´í—˜ íšŒì›ê°€ì… í”Œë¡œìš° (`01-trial-signup.spec.ts`)
- âœ… ì²´í—˜ ë¼ì´ì„ ìŠ¤ ìë™ ë°œê¸‰
- âœ… ë””ë°”ì´ìŠ¤ í•‘ê±°í”„ë¦°íŠ¸ ìƒì„± ë° ì¿ í‚¤ ì €ì¥
- âœ… íšŒì›ê°€ì… ì™„ë£Œ ë° ë¦¬ë‹¤ì´ë ‰íŠ¸
- âœ… í¼ ê²€ì¦ (ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸)

### 2. ì¤‘ë³µ ì²´í—˜ ë°©ì§€ (`02-duplicate-trial-prevention.spec.ts`)
- âœ… ë™ì¼ ë””ë°”ì´ìŠ¤ì—ì„œ ì¤‘ë³µ ì²´í—˜ ì°¨ë‹¨
- âœ… ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ì—ì„œ ì²´í—˜ í—ˆìš©
- âœ… trial_device_fingerprints í…Œì´ë¸” ê²€ì¦

### 3. ë””ë°”ì´ìŠ¤ ë°”ì¸ë”© (`03-device-binding.spec.ts`)
- âœ… ì²´í—˜ ë¼ì´ì„ ìŠ¤ ë””ë°”ì´ìŠ¤ ì œí•œ
- âœ… ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ì—ì„œ ë¡œê·¸ì¸ ì°¨ë‹¨
- âœ… ë“±ë¡ëœ ë””ë°”ì´ìŠ¤ì—ì„œ ì •ìƒ ì ‘ê·¼
- âœ… device_tokens ë°°ì—´ ê²€ì¦

### 4. ì²´í—˜ ë§Œë£Œ ì²˜ë¦¬ (`04-trial-expiration.spec.ts`)
- âœ… ë§Œë£Œëœ ë¼ì´ì„ ìŠ¤ ë¦¬ë‹¤ì´ë ‰íŠ¸
- âœ… ë§Œë£Œ 3ì¼ ì „ ê²½ê³  í‘œì‹œ
- âœ… ë¯¸ë“¤ì›¨ì–´ ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸

### 5. ë¼ì´ì„ ìŠ¤ ê³µìœ  ë°©ì§€ (`05-license-sharing-prevention.spec.ts`)
- âœ… ìœ ë£Œ ë¼ì´ì„ ìŠ¤ ì¤‘ë³µ í™œì„±í™” ì°¨ë‹¨
- âœ… ë‹¤ë¥¸ ì‚¬ìš©ì í™œì„±í™” ì‹œë„ ì°¨ë‹¨
- âœ… planner_id ê²€ì¦

## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ì‚¬ì „ ì¤€ë¹„

1. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •** (`.env.local` íŒŒì¼)
```bash
# Supabase (í•„ìˆ˜)
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# Test Base URL (ì„ íƒì‚¬í•­)
PLAYWRIGHT_TEST_BASE_URL=http://localhost:3000
```

2. **Playwright ë¸Œë¼ìš°ì € ì„¤ì¹˜**
```bash
npm run playwright:install
```

3. **ê°œë°œ ì„œë²„ ì‹¤í–‰** (ë³„ë„ í„°ë¯¸ë„)
```bash
npm run dev
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´

```bash
# ì „ì²´ E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (headless)
npm run test:e2e

# UI ëª¨ë“œë¡œ ì‹¤í–‰ (í…ŒìŠ¤íŠ¸ ì„ íƒ ë° ë””ë²„ê¹…)
npm run test:e2e:ui

# ë¸Œë¼ìš°ì €ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ëª¨ë“œë¡œ ì‹¤í–‰
npm run test:e2e:headed

# ë””ë²„ê·¸ ëª¨ë“œ (ë‹¨ê³„ë³„ ì‹¤í–‰)
npm run test:e2e:debug

# íŠ¹ì • íŒŒì¼ë§Œ ì‹¤í–‰
npx playwright test tests/e2e/01-trial-signup.spec.ts

# íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
npx playwright test -g "should complete trial signup successfully"
```

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼

í…ŒìŠ¤íŠ¸ ì‹¤í–‰ í›„ ê²°ê³¼ëŠ” ë‹¤ìŒ ìœ„ì¹˜ì— ì €ì¥ë©ë‹ˆë‹¤:

- **HTML ë¦¬í¬íŠ¸**: `playwright-report/index.html`
- **ìŠ¤í¬ë¦°ìƒ·**: `test-results/` (ì‹¤íŒ¨ ì‹œ)
- **íŠ¸ë ˆì´ìŠ¤**: `test-results/` (ì¬ì‹œë„ ì‹œ)

HTML ë¦¬í¬íŠ¸ ë³´ê¸°:
```bash
npx playwright show-report
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### í…ŒìŠ¤íŠ¸ ê²©ë¦¬
- ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤
- `beforeEach`ì—ì„œ ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
- `afterEach`ì—ì„œ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì •ë¦¬

### ë°ì´í„° ì •ë¦¬
- í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ ë‹¤ìŒ í•­ëª© ì •ë¦¬:
  - í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ê³„ì •
  - í…ŒìŠ¤íŠ¸ ë¼ì´ì„ ìŠ¤
  - ë””ë°”ì´ìŠ¤ í•‘ê±°í”„ë¦°íŠ¸ ë ˆì½”ë“œ
  - í”„ë¡œí•„ ë°ì´í„°

### Supabase Service Role Key
- Service Role KeyëŠ” **í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë§Œ** ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- Production í™˜ê²½ì—ì„œëŠ” ì ˆëŒ€ ë…¸ì¶œí•˜ì§€ ë§ˆì„¸ìš”
- `.env.local`ì€ `.gitignore`ì— í¬í•¨ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤

### ë™ì‹œ ì‹¤í–‰ ì œí•œ
- `workers: 1` ì„¤ì •ìœ¼ë¡œ ìˆœì°¨ ì‹¤í–‰
- ë°ì´í„°ë² ì´ìŠ¤ ì¼ê´€ì„± ìœ ì§€ë¥¼ ìœ„í•´ í•„ìš”
- ë³‘ë ¬ ì‹¤í–‰ ì‹œ Race Condition ë°œìƒ ê°€ëŠ¥

## ğŸ› ë¬¸ì œ í•´ê²°

### í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ
1. **ê°œë°œ ì„œë²„ í™•ì¸**: `localhost:3000` ì ‘ê·¼ ê°€ëŠ¥í•œì§€ í™•ì¸
2. **í™˜ê²½ ë³€ìˆ˜ í™•ì¸**: Supabase í‚¤ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
3. **ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ**: ì´ì „ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ë‚¨ì•„ìˆëŠ”ì§€ í™•ì¸
4. **ë¡œê·¸ í™•ì¸**: ì½˜ì†” ë¡œê·¸ì™€ Playwright ë¦¬í¬íŠ¸ í™•ì¸

### íƒ€ì„ì•„ì›ƒ ì—ëŸ¬
- ê°œë°œ ì„œë²„ê°€ ëŠë¦° ê²½ìš° `playwright.config.ts`ì—ì„œ íƒ€ì„ì•„ì›ƒ ì¦ê°€
- ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
- Supabase ì‘ë‹µ ì‹œê°„ í™•ì¸

### ë””ë°”ì´ìŠ¤ í•‘ê±°í”„ë¦°íŠ¸ ì¶©ëŒ
- í…ŒìŠ¤íŠ¸ ê²©ë¦¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì€ ê²½ìš°
- `afterEach`ì—ì„œ ì •ë¦¬ ì½”ë“œ í™•ì¸
- ìˆ˜ë™ìœ¼ë¡œ `trial_device_fingerprints` í…Œì´ë¸” ì •ë¦¬

## ğŸ“ í…ŒìŠ¤íŠ¸ ì‘ì„± ê°€ì´ë“œ

ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ì‹œ:

1. **íŒŒì¼ ì´ë¦„**: `##-test-name.spec.ts` (ë²ˆí˜¸ìˆœ)
2. **í—¬í¼ í•¨ìˆ˜ ì‚¬ìš©**: `helpers.ts`ì˜ ìœ í‹¸ë¦¬í‹° í™œìš©
3. **ë°ì´í„° ì •ë¦¬**: `beforeEach`/`afterEach` êµ¬í˜„
4. **ëª…í™•í•œ ì„¤ëª…**: í…ŒìŠ¤íŠ¸ ëª©ì ê³¼ ë‹¨ê³„ë¥¼ ì£¼ì„ìœ¼ë¡œ ì‘ì„±
5. **ë‹¨ì–¸ë¬¸**: ëª…í™•í•˜ê³  ì˜ë¯¸ ìˆëŠ” ë‹¨ì–¸ë¬¸ ì‚¬ìš©

ì˜ˆì‹œ:
```typescript
test('should do something', async ({ page }) => {
  // Given (ì¤€ë¹„)
  const testData = setupTestData();

  // When (ì‹¤í–‰)
  await performAction(page, testData);

  // Then (ê²€ì¦)
  await expect(result).toBeExpected();

  // Cleanup (ì •ë¦¬)
  await cleanupTestData(testData);
});
```

## ğŸ”— ì°¸ê³  ìë£Œ

- [Playwright ê³µì‹ ë¬¸ì„œ](https://playwright.dev)
- [Supabase Testing](https://supabase.com/docs/guides/platform/testing)
- [í”„ë¡œì íŠ¸ ê³„íšì„œ](/Users/twins/.claude/plans/curious-marinating-glade.md)
