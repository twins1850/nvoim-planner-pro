# ê°œë°œì¼ì§€ - 2026ë…„ 2ì›” 3ì¼

## í”Œë˜ë„ˆ â†” í•™ìƒ ë©”ì‹œì§• ì‹œìŠ¤í…œ í†µí•© í…ŒìŠ¤íŠ¸ ë° ìˆ˜ì •

### ğŸ“‹ ì‘ì—… ê°œìš”
- **ëª©ì **: í”Œë˜ë„ˆ ì›¹ ì•±ê³¼ í•™ìƒ ëª¨ë°”ì¼ ì•± ê°„ ì‹¤ì‹œê°„ ë©”ì‹œì§• ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •
- **ì‘ì—… ì‹œê°„**: 17:00 ~ 19:00 (ì•½ 2ì‹œê°„)
- **í™˜ê²½**:
  - í”Œë˜ë„ˆ ì•±: http://localhost:3000 (Next.js 15.5.10)
  - í•™ìƒ ì•±: http://localhost:10001 (React Native Expo Web)
  - ë°ì´í„°ë² ì´ìŠ¤: Supabase (PostgreSQL)
  - í…ŒìŠ¤íŠ¸ ë„êµ¬: Playwright MCP (ë©€í‹°íƒ­ ë¸Œë¼ìš°ì € ìë™í™”)

### ğŸ¯ ì‘ì—… ì„±ê³¼ ìš”ì•½

**ìˆ˜ì •ëœ íŒŒì¼**: 5ê°œ
- `/apps/student/src/screens/MessagesScreen.tsx`
- `/apps/planner-web/src/app/dashboard/messages/MessagesContent.tsx`
- `/apps/planner-web/src/app/dashboard/students/[id]/StudentDetailContent.tsx`
- `/apps/planner-web/src/components/AddSubscriptionForm.tsx`
- `/ê°œë°œì¼ì§€_2026-02-03_ë©”ì‹œì§•_í…ŒìŠ¤íŠ¸.md`

**ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸**: 3ê°œ
- `force-connect-student-to-planner.js`
- `check-conversations-schema.js`
- `check-messages-data.js`

**ë°œê²¬ ë° ìˆ˜ì •ëœ ë²„ê·¸**: 5ê°œ
1. âœ… í•™ìƒ ì•± MessagesScreen - ì˜ëª»ëœ í…Œì´ë¸” ì°¸ì¡° (`students` â†’ `student_profiles`)
2. âœ… í”Œë˜ë„ˆ ì•± MessagesContent - ì˜ëª»ëœ í…Œì´ë¸” ë° ì»¬ëŸ¼ ì°¸ì¡°
3. âœ… Expo HMR ë¬¸ì œ - ê°œë°œ ì„œë²„ ì„¤ì • ìˆ˜ì •
4. âœ… í•™ìƒ ìƒì„¸ í˜ì´ì§€ - `name` â†’ `full_name` ì»¬ëŸ¼ëª… ìˆ˜ì •
5. âœ… ìˆ˜ê°•ê¶Œ ë‚ ì§œ ì œí•œ - ê³¼ê±° ë‚ ì§œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì •

**í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
- âœ… í•™ìƒ â†’ í”Œë˜ë„ˆ ì‹¤ì‹œê°„ ë©”ì‹œì§• ì‘ë™
- âœ… í”Œë˜ë„ˆ â†’ í•™ìƒ ì‹¤ì‹œê°„ ë©”ì‹œì§• ì‘ë™
- âœ… í•™ìƒ ìƒì„¸ ì •ë³´ í˜ì´ì§€ ì •ìƒ ë¡œë“œ
- âœ… ìˆ˜ê°•ê¶Œ ë“±ë¡ ì‹œ ê³¼ê±° ë‚ ì§œ ì„ íƒ ê°€ëŠ¥

### ğŸ” ë°œê²¬ëœ ë¬¸ì œ

#### 1. í•™ìƒ ì•± MessagesScreen ì—ëŸ¬
**ì¦ìƒ**: "ì—°ê²°ëœ ì„ ìƒë‹˜ì´ ì—†ìŠµë‹ˆë‹¤" ì—ëŸ¬ ë°œìƒ

**ì›ì¸**:
- ì˜ëª»ëœ í…Œì´ë¸” ì¡°íšŒ: `students` í…Œì´ë¸” (ì¡´ì¬í•˜ì§€ ì•ŠìŒ)
- ì˜ëª»ëœ ì»¬ëŸ¼ëª…: `user_id`, `teacher_id`

**ìˆ˜ì • ë‚´ìš©** (`apps/student/src/screens/MessagesScreen.tsx`):
```typescript
// âŒ ì´ì „ ì½”ë“œ
const { data: studentData } = await supabase
  .from('students')  // ì˜ëª»ëœ í…Œì´ë¸”
  .select(`id, teacher_id`)
  .eq('user_id', user.id);

// âœ… ìˆ˜ì •ëœ ì½”ë“œ
const { data: studentData } = await supabase
  .from('student_profiles')  // ì˜¬ë°”ë¥¸ í…Œì´ë¸”
  .select(`id, planner_id`)
  .eq('id', user.id)
  .maybeSingle();

// conversations í…Œì´ë¸” ì¿¼ë¦¬ë„ ìˆ˜ì •
const { data: conversationData } = await supabase
  .from('conversations')
  .select('id')
  .eq('teacher_id', student.planner_id)  // teacher_id ì‚¬ìš© (conversations í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ)
  .eq('student_id', user.id)
  .maybeSingle();
```

#### 2. í”Œë˜ë„ˆ ì•± MessagesContent ì—ëŸ¬
**ì¦ìƒ**: ëŒ€í™” ëª©ë¡ì´ ë¹„ì–´ìˆìŒ ("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤")

**ì›ì¸**:
- ì˜ëª»ëœ í…Œì´ë¸” ì¡°íšŒ: `students` í…Œì´ë¸”
- ì˜ëª»ëœ ì»¬ëŸ¼ëª…: `teacher_id`, `user_id`, `name`

**ìˆ˜ì • ë‚´ìš©** (`apps/planner-web/src/app/dashboard/messages/MessagesContent.tsx`):
```typescript
// âŒ ì´ì „ ì½”ë“œ
const { data: students } = await supabase
  .from('students')
  .select(`id, user_id, name, is_connected`)
  .eq('teacher_id', user.id)
  .eq('is_connected', true);

// âœ… ìˆ˜ì •ëœ ì½”ë“œ
const { data: students } = await supabase
  .from('student_profiles')
  .select(`id, full_name, planner_id`)
  .eq('planner_id', user.id);

// ëŒ€í™” ì •ë³´ ê°€ì ¸ì˜¤ê¸° ë¶€ë¶„ë„ ìˆ˜ì •
participant_id: student.id,        // user_id â†’ id
participant_name: student.full_name, // name â†’ full_name
```

#### 3. Expo Hot Module Replacement ë¬¸ì œ
**ì¦ìƒ**: ì½”ë“œ ë³€ê²½ì‚¬í•­ì´ ë¸Œë¼ìš°ì €ì— ë°˜ì˜ë˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
1. ì •ì  íŒŒì¼ ì„œë²„ ì¤‘ì§€ (`npm start` â†’ `serve web-build`)
2. ì‹¤ì œ ê°œë°œ ì„œë²„ ì‹œì‘: `npx expo start --web --port 10001`
3. Metro bundlerê°€ ë³€ê²½ì‚¬í•­ ê°ì§€í•˜ì—¬ ìë™ ë¦¬ë¹Œë“œ

#### 4. í•™ìƒ ìƒì„¸ ì •ë³´ í˜ì´ì§€ ì—ëŸ¬
**ì¦ìƒ**: "Cannot read properties of null (reading 'charAt')" ì—ëŸ¬ ë°œìƒ

**ì›ì¸**:
- ì˜ëª»ëœ í…Œì´ë¸” ì¡°íšŒ: `students` í…Œì´ë¸” (ì¡´ì¬í•˜ì§€ ì•ŠìŒ)
- ì˜ëª»ëœ ì»¬ëŸ¼ëª…: `name` (ì‹¤ì œë¡œëŠ” `full_name`)
- ì¸í„°í˜ì´ìŠ¤ì™€ ì‹¤ì œ ë°ì´í„° ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜

**ìˆ˜ì • ë‚´ìš©** (`apps/planner-web/src/app/dashboard/students/[id]/StudentDetailContent.tsx`):
```typescript
// âŒ ì´ì „ ì½”ë“œ
interface Student {
  id: string;
  name: string;  // ì˜ëª»ëœ ì»¬ëŸ¼ëª…
  // ... other required fields
}

const { data: studentData } = await supabase
  .from('students')  // ì˜ëª»ëœ í…Œì´ë¸”
  .select('*')
  .eq('id', studentId)
  .eq('teacher_id', user.id)  // ì˜ëª»ëœ ì»¬ëŸ¼ëª…
  .single();

{student.name.charAt(0)}  // ì—ëŸ¬ ë°œìƒ ì§€ì 

// âœ… ìˆ˜ì •ëœ ì½”ë“œ
interface Student {
  id: string;
  full_name: string;  // ì˜¬ë°”ë¥¸ ì»¬ëŸ¼ëª…
  email: string;
  phone?: string;
  planner_id?: string;
  // ... other optional fields
}

const { data: studentData } = await supabase
  .from('student_profiles')  // ì˜¬ë°”ë¥¸ í…Œì´ë¸”
  .select('*')
  .eq('id', studentId)
  .eq('planner_id', user.id)  // ì˜¬ë°”ë¥¸ ì»¬ëŸ¼ëª…
  .single();

{student.full_name.charAt(0)}  // ì •ìƒ ì‘ë™
```

#### 5. ìˆ˜ê°•ê¶Œ ì‹œì‘ì¼ ë‚ ì§œ ì œí•œ ë¬¸ì œ
**ì¦ìƒ**: ìˆ˜ê°• ì‹œì‘ì¼ ì„ íƒ ì‹œ ì˜¤ëŠ˜ ì´ì „ ë‚ ì§œ ì„ íƒ ë¶ˆê°€

**ì›ì¸**:
- `min={new Date().toISOString().split('T')[0]}` ì†ì„±ìœ¼ë¡œ ì¸í•´ ê³¼ê±° ë‚ ì§œ ì„ íƒ ì°¨ë‹¨
- ê¸°ì¡´ ìˆ˜ê°•ìƒì˜ ê²½ìš° í”„ë¡œê·¸ë¨ ë„ì… ì´ì „ì— ìˆ˜ê°• ì‹œì‘í•œ ê²½ìš°ê°€ ëŒ€ë¶€ë¶„
- ê³¼ê±° ë‚ ì§œ ë“±ë¡ ë¶ˆê°€ë¡œ ì¸í•´ ì •í™•í•œ ìˆ˜ê°•ê¶Œ ê°±ì‹  ì£¼ê¸° ê³„ì‚° ë¶ˆê°€

**ìˆ˜ì • ë‚´ìš©** (`apps/planner-web/src/components/AddSubscriptionForm.tsx`):
```typescript
// âŒ ì´ì „ ì½”ë“œ (Line 303-309)
<input
  type="date"
  value={startDate}
  onChange={(e) => setStartDate(e.target.value)}
  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  min={new Date().toISOString().split('T')[0]}  // ê³¼ê±° ë‚ ì§œ ì„ íƒ ë¶ˆê°€
/>

// âœ… ìˆ˜ì •ëœ ì½”ë“œ (Line 303-308)
<input
  type="date"
  value={startDate}
  onChange={(e) => setStartDate(e.target.value)}
  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
  // min ì†ì„± ì œê±° - ëª¨ë“  ë‚ ì§œ ì„ íƒ ê°€ëŠ¥
/>
```

**ê²°ê³¼**: í”Œë˜ë„ˆê°€ ê¸°ì¡´ ìˆ˜ê°•ìƒì˜ ê³¼ê±° ìˆ˜ê°• ì‹œì‘ì¼ì„ ì •í™•íˆ ë“±ë¡í•˜ì—¬ ìˆ˜ê°•ê¶Œ ê°±ì‹  ì£¼ê¸°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ ë¨

### âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼

#### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
**í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸**: `force-connect-student-to-planner.js`

```javascript
// í•™ìƒ-í”Œë˜ë„ˆ ì—°ê²° ìƒì„±
const plannerId = 'a3480c6a-4a29-4109-9f1b-dbcaddd56baa';
const studentId = '3418a06e-7485-40bf-9126-c0ca06da31db';

// student_profiles í…Œì´ë¸” ì—…ë°ì´íŠ¸
await supabase
  .from('student_profiles')
  .update({ planner_id: plannerId })
  .eq('id', studentId);
```

**ê²°ê³¼**: âœ… ì—°ê²° ì„±ê³µ

#### ëŒ€í™” ë° ë©”ì‹œì§€ ë°ì´í„° í™•ì¸
**í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸**: `check-messages-data.js`

**ê²°ê³¼**:
```
âœ… Conversations ìˆ˜: 1
   - ID: 7f5243c2-cd04-461a-8a03-2a2ec055ad6b
   - Teacher: a3480c6a-4a29-4109-9f1b-dbcaddd56baa
   - Student: 3418a06e-7485-40bf-9126-c0ca06da31db

âœ… Messages ìˆ˜: 1
   - Sender: 3418a06e-7485-40bf-9126-c0ca06da31db (í•™ìƒ)
   - Content: ì•ˆë…•í•˜ì„¸ìš” ì„ ìƒë‹˜! í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤.
   - Created: 2026-02-03T09:39:47.183437+00:00
```

#### ì‹¤ì‹œê°„ ë©”ì‹œì§• í…ŒìŠ¤íŠ¸

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ 1: í•™ìƒ â†’ í”Œë˜ë„ˆ**
1. í•™ìƒ ì•±ì—ì„œ ë©”ì‹œì§€ ì…ë ¥: "ì•ˆë…•í•˜ì„¸ìš” ì„ ìƒë‹˜! í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ì…ë‹ˆë‹¤."
2. ì „ì†¡ ë²„íŠ¼ í´ë¦­
3. âœ… í•™ìƒ ì•± UIì— ë©”ì‹œì§€ ì¦‰ì‹œ í‘œì‹œ
4. âœ… íƒ€ì„ìŠ¤íƒ¬í”„ í‘œì‹œ: "18:39", "ë°©ê¸ˆ ì „"
5. âœ… ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  ë¡œê·¸ í™•ì¸
6. âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ë©”ì‹œì§€ ì €ì¥ í™•ì¸

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ 2: í”Œë˜ë„ˆ â†’ í•™ìƒ**
1. í”Œë˜ë„ˆ ì•± ë©”ì‹œì§€ í˜ì´ì§€ ì ‘ì†
2. âœ… ëŒ€í™” ëª©ë¡ í‘œì‹œ: "ì‹ ê·œí•™ìƒ", "í…ŒìŠ¤íŠ¸í•™ìƒ"
3. âœ… ë§ˆì§€ë§‰ ë©”ì‹œì§€ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
4. âœ… ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì¹´ìš´íŠ¸: 1
5. "ì‹ ê·œí•™ìƒ" ëŒ€í™” í´ë¦­
6. âœ… ì „ì²´ ë©”ì‹œì§€ ë‚´ì—­ í‘œì‹œ
7. ë‹µì¥ ì…ë ¥: "ì•ˆë…•! í…ŒìŠ¤íŠ¸ ë‹µì¥ì…ë‹ˆë‹¤. ë©”ì‹œì§€ê°€ ì˜ ë„ì°©í–ˆë„¤ìš”!"
8. âœ… í”Œë˜ë„ˆ ì•± UIì— ë©”ì‹œì§€ ì¦‰ì‹œ í‘œì‹œ
9. âœ… í•™ìƒ ì•±ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ë©”ì‹œì§€ ìˆ˜ì‹ 
10. âœ… í•™ìƒ ì•± UI ìë™ ì—…ë°ì´íŠ¸

### ğŸ¯ ìµœì¢… í™•ì¸ ì‚¬í•­

#### í•™ìƒ ì•± (localhost:10001)
- âœ… MessagesScreen ë¡œë“œ ì„±ê³µ
- âœ… í”Œë˜ë„ˆ ì—°ê²° ìƒíƒœ í‘œì‹œ: "í”Œë˜ë„ˆ", "ì—°ê²°ë¨"
- âœ… ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ
- âœ… ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  ì‘ë™
- âœ… UI ì •ìƒ ì—…ë°ì´íŠ¸

#### í”Œë˜ë„ˆ ì•± (localhost:3000)
- âœ… MessagesContent ë¡œë“œ ì„±ê³µ
- âœ… ëŒ€í™” ëª©ë¡ í‘œì‹œ (2ëª…)
- âœ… ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ
- âœ… ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  ì‘ë™
- âœ… UI ì •ìƒ ì—…ë°ì´íŠ¸

#### ë°ì´í„°ë² ì´ìŠ¤
- âœ… student_profiles.planner_id ì˜¬ë°”ë¥´ê²Œ ì„¤ì •
- âœ… conversations í…Œì´ë¸” ìƒì„± (teacher_id, student_id)
- âœ… messages í…Œì´ë¸” ì €ì¥ (conversation_id, sender_id, content)
- âœ… ì‹¤ì‹œê°„ êµ¬ë… ì‘ë™ (Supabase Realtime)

### ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¸

#### conversations í…Œì´ë¸”
```sql
CREATE TABLE conversations (
  id UUID PRIMARY KEY,
  teacher_id UUID REFERENCES profiles(id),  -- í”Œë˜ë„ˆ ID
  student_id UUID REFERENCES profiles(id),  -- í•™ìƒ ID
  last_message_time TIMESTAMPTZ,
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
);
```

**ì¤‘ìš”**: `teacher_id` ì»¬ëŸ¼ ì‚¬ìš© (í”Œë˜ë„ˆë¥¼ teacherë¡œ ì§€ì¹­)

#### student_profiles í…Œì´ë¸”
```sql
CREATE TABLE student_profiles (
  id UUID PRIMARY KEY REFERENCES profiles(id),
  full_name TEXT,
  email TEXT,
  phone TEXT,
  planner_id UUID REFERENCES profiles(id)  -- ì—°ê²°ëœ í”Œë˜ë„ˆ
);
```

### ğŸ› ï¸ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

1. **`/apps/student/src/screens/MessagesScreen.tsx`**
   - Line 113: `from('students')` â†’ `from('student_profiles')`
   - Line 114-115: `user_id`, `teacher_id` â†’ `id`, `planner_id`
   - Line 145-150: conversations ì¿¼ë¦¬ `teacher_id` ì‚¬ìš©

2. **`/apps/planner-web/src/app/dashboard/messages/MessagesContent.tsx`**
   - Line 126: `from('students')` â†’ `from('student_profiles')`
   - Line 128-131: `user_id`, `name`, `is_connected` â†’ `id`, `full_name`
   - Line 133: `teacher_id` â†’ `planner_id`
   - Line 148, 157, 190-191: `student.user_id`, `student.name` â†’ `student.id`, `student.full_name`

3. **`/apps/planner-web/src/app/dashboard/students/[id]/StudentDetailContent.tsx`**
   - Line 33-52: Student interface ìˆ˜ì • - `name` â†’ `full_name`, ëª¨ë“  ì†ì„± optionalë¡œ ë³€ê²½
   - Line 132-137: `from('students')` â†’ `from('student_profiles')`, `teacher_id` â†’ `planner_id`
   - Line 244, 247: `student.name` â†’ `student.full_name`

4. **`/apps/planner-web/src/components/AddSubscriptionForm.tsx`**
   - Line 308: `min={new Date().toISOString().split('T')[0]}` ì œê±° - ê³¼ê±° ë‚ ì§œ ì„ íƒ ê°€ëŠ¥

5. **ìƒì„±ëœ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸**
   - `force-connect-student-to-planner.js`
   - `check-conversations-schema.js`
   - `check-messages-data.js`

### ğŸ’¡ í•™ìŠµ ë‚´ìš©

1. **í…Œì´ë¸” ëª…ëª… ê·œì¹™**:
   - `students` í…Œì´ë¸”ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ âš ï¸
   - `student_profiles` í…Œì´ë¸” ì‚¬ìš© âœ…
   - `planner_id` ì»¬ëŸ¼ìœ¼ë¡œ í”Œë˜ë„ˆ ì—°ê²°
   - `full_name` ì»¬ëŸ¼ ì‚¬ìš© (nameì´ ì•„ë‹˜)

2. **conversations í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ**:
   - `teacher_id` ì»¬ëŸ¼ ì‚¬ìš© (í”Œë˜ë„ˆë¥¼ teacherë¡œ ì§€ì¹­)
   - `student_id` ì»¬ëŸ¼ ì‚¬ìš©
   - í”Œë˜ë„ˆì™€ í•™ìƒ ê°„ 1:1 ëŒ€ì‘

3. **Expo ê°œë°œ í™˜ê²½**:
   - `npm start` â†’ ì •ì  íŒŒì¼ ì„œë²„ (Hot Reload ì—†ìŒ)
   - `npx expo start --web` â†’ Metro bundler (Hot Reload ì§€ì›)
   - ì½”ë“œ ë³€ê²½ í›„ ê°œë°œ ì„œë²„ ì¬ì‹œì‘ í•„ìš”

4. **Supabase Realtime**:
   - í´ë¼ì´ì–¸íŠ¸ SDKë¡œ ì‹¤ì‹œê°„ êµ¬ë… ê°€ëŠ¥
   - `messages` í…Œì´ë¸” INSERT ì´ë²¤íŠ¸ ê°ì§€
   - UI ìë™ ì—…ë°ì´íŠ¸ êµ¬í˜„

### ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ê°€ì´ë“œ (ì¤‘ìš”!)

#### âš ï¸ ì£¼ì˜ì‚¬í•­
í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ë‹¤ìŒ ê·œì¹™ì„ **ë°˜ë“œì‹œ** ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:

**í•™ìƒ ì •ë³´ ì°¸ì¡° ì‹œ**:
```typescript
// âŒ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€
.from('students')          // í…Œì´ë¸” ì¡´ì¬í•˜ì§€ ì•ŠìŒ
.select('name')            // ì»¬ëŸ¼ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
.eq('teacher_id', ...)     // student_profilesì—ëŠ” planner_id ì‚¬ìš©
.eq('user_id', ...)        // student_profilesì—ëŠ” id ì‚¬ìš©

// âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš©
.from('student_profiles')  // ì •í™•í•œ í…Œì´ë¸”ëª…
.select('full_name')       // ì •í™•í•œ ì»¬ëŸ¼ëª…
.eq('planner_id', ...)     // student_profilesì˜ í”Œë˜ë„ˆ ì°¸ì¡°
.eq('id', ...)             // student_profilesì˜ í”„ë¡œí•„ ID
```

**ëŒ€í™” ì •ë³´ ì°¸ì¡° ì‹œ**:
```typescript
// âœ… conversations í…Œì´ë¸”ì€ teacher_id ì‚¬ìš©
.from('conversations')
.eq('teacher_id', plannerId)  // í”Œë˜ë„ˆë¥¼ teacherë¡œ ì§€ì¹­
.eq('student_id', studentId)
```

#### í…Œì´ë¸” ê´€ê³„ë„
```
profiles (ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´)
  â”œâ”€ id (UUID, PK)
  â”œâ”€ email
  â””â”€ role (planner | student)

student_profiles (í•™ìƒ ìƒì„¸ ì •ë³´)
  â”œâ”€ id (UUID, PK) â†’ profiles.id
  â”œâ”€ full_name (TEXT) âš ï¸ 'name'ì´ ì•„ë‹˜!
  â”œâ”€ email (TEXT)
  â”œâ”€ phone (TEXT)
  â””â”€ planner_id (UUID) â†’ profiles.id âš ï¸ 'teacher_id'ê°€ ì•„ë‹˜!

conversations (ëŒ€í™”ë°©)
  â”œâ”€ id (UUID, PK)
  â”œâ”€ teacher_id (UUID) â†’ profiles.id âš ï¸ ì—¬ê¸°ì„œëŠ” 'teacher_id' ì‚¬ìš©
  â”œâ”€ student_id (UUID) â†’ profiles.id
  â””â”€ last_message_time (TIMESTAMPTZ)

messages (ë©”ì‹œì§€)
  â”œâ”€ id (UUID, PK)
  â”œâ”€ conversation_id (UUID) â†’ conversations.id
  â”œâ”€ sender_id (UUID) â†’ profiles.id
  â”œâ”€ content (TEXT)
  â””â”€ created_at (TIMESTAMPTZ)
```

### ğŸ‰ ê²°ë¡ 

**ëª¨ë“  ë°œê²¬ëœ ë¬¸ì œê°€ ì„±ê³µì ìœ¼ë¡œ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!**

**ë©”ì‹œì§• ì‹œìŠ¤í…œ**:
- âœ… ì–‘ë°©í–¥ ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ
- âœ… ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  ì‘ë™
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ ì •ìƒ
- âœ… UI ì—…ë°ì´íŠ¸ ìë™í™”

**í•™ìƒ ì •ë³´ ê´€ë¦¬**:
- âœ… í•™ìƒ ìƒì„¸ í˜ì´ì§€ ì •ìƒ ë¡œë“œ
- âœ… ëª¨ë“  í•™ìƒ ì •ë³´ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œ
- âœ… ìˆ˜ê°•ê¶Œ ì‹œì‘ì¼ ê³¼ê±° ë‚ ì§œ ì„ íƒ ê°€ëŠ¥

**ê³µí†µ ìˆ˜ì • ì‚¬í•­**:
- âœ… `students` â†’ `student_profiles` í…Œì´ë¸” ì°¸ì¡° ìˆ˜ì •
- âœ… `name` â†’ `full_name` ì»¬ëŸ¼ëª… ìˆ˜ì •
- âœ… `teacher_id` â†’ `planner_id` ì»¬ëŸ¼ëª… ìˆ˜ì • (student_profilesì—ì„œ)
- âœ… `conversations` í…Œì´ë¸”ì€ `teacher_id` ì‚¬ìš© (ì •ìƒ)

### ğŸ”œ ë‹¤ìŒ ë‹¨ê³„

#### ì¦‰ì‹œ í•„ìš”í•œ ì‘ì—…
1. ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ `students` í…Œì´ë¸” ë˜ëŠ” `name` ì»¬ëŸ¼ ì°¸ì¡° ì—¬ë¶€ ì „ì²´ ê²€ìƒ‰
2. ëª¨ë“  ë‚ ì§œ ì…ë ¥ í•„ë“œì˜ ì œì•½ ì‚¬í•­ ê²€í† 

#### ê¸°ëŠ¥ ê°œì„ 
1. E2E í…ŒìŠ¤íŠ¸ ì‘ì„± (Playwright)
2. ì½ìŒ ìƒíƒœ ì¶”ì  êµ¬í˜„
3. íŒŒì¼ ì²¨ë¶€ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
4. ì˜¤í”„ë¼ì¸ ë©”ì‹œì§€ í í…ŒìŠ¤íŠ¸
5. ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ ì²˜ë¦¬ ìµœì í™”

#### ì¶”ê°€ í†µí•© í…ŒìŠ¤íŠ¸
1. ë¹„ë””ì˜¤ ì—…ë¡œë“œ ë° AI ë¶„ì„ í…ŒìŠ¤íŠ¸
2. êµ¬ë… ê´€ë¦¬ ë° ë§Œë£Œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸
3. í•™ìƒ ì•± ì „ì²´ ê¸°ëŠ¥ í†µí•© í…ŒìŠ¤íŠ¸

---

**ì‘ì—… ì‹œì‘ ì‹œê°„**: 2026ë…„ 2ì›” 3ì¼ 17:00
**ì‘ì—… ì™„ë£Œ ì‹œê°„**: 2026ë…„ 2ì›” 3ì¼ 19:00
**ì´ ì†Œìš” ì‹œê°„**: ì•½ 2ì‹œê°„
**í…ŒìŠ¤íŠ¸ í™˜ê²½**: ë¡œì»¬ ê°œë°œ í™˜ê²½ (Playwright MCP)
**ì‘ì„±ì**: Claude Code (with Playwright MCP)

**ì‘ì—… ìš”ì•½**:
- 5ê°œ íŒŒì¼ ìˆ˜ì • (MessagesScreen, MessagesContent, StudentDetailContent, AddSubscriptionForm + ê°œë°œì¼ì§€)
- 3ê°œ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
- 5ê°œ ì£¼ìš” ë²„ê·¸ ë°œê²¬ ë° ìˆ˜ì •
- ì–‘ë°©í–¥ ì‹¤ì‹œê°„ ë©”ì‹œì§• ì‹œìŠ¤í…œ ì™„ì „ ë³µêµ¬
- í•™ìƒ ì •ë³´ ê´€ë¦¬ ì‹œìŠ¤í…œ ì •ìƒí™”

---

## ğŸ”– ë¹ ë¥¸ ì°¸ì¡° ì¹´ë“œ (Quick Reference)

### ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

**í•™ìƒ ì •ë³´ ì¡°íšŒ ì‹œ**:
- [ ] `student_profiles` í…Œì´ë¸” ì‚¬ìš© (students âŒ)
- [ ] `full_name` ì»¬ëŸ¼ ì‚¬ìš© (name âŒ)
- [ ] `planner_id` ì»¬ëŸ¼ ì‚¬ìš© (teacher_id âŒ)
- [ ] `id` ì»¬ëŸ¼ìœ¼ë¡œ í•™ìƒ ì‹ë³„ (user_id âŒ)

**ëŒ€í™” ì •ë³´ ì¡°íšŒ ì‹œ**:
- [ ] `conversations` í…Œì´ë¸” ì‚¬ìš©
- [ ] `teacher_id` ì»¬ëŸ¼ìœ¼ë¡œ í”Œë˜ë„ˆ ì°¸ì¡° âœ…
- [ ] `student_id` ì»¬ëŸ¼ìœ¼ë¡œ í•™ìƒ ì°¸ì¡° âœ…

**ë©”ì‹œì§€ ì¡°íšŒ ì‹œ**:
- [ ] `messages` í…Œì´ë¸” ì‚¬ìš©
- [ ] `conversation_id`ë¡œ ëŒ€í™”ë°© ì°¸ì¡°
- [ ] `sender_id`ë¡œ ë°œì‹ ì ì‹ë³„

### ìì£¼ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜ (Common Mistakes)

| âŒ ì˜ëª»ëœ ì½”ë“œ | âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ |
|-------------|-------------|
| `.from('students')` | `.from('student_profiles')` |
| `.select('name')` | `.select('full_name')` |
| `.eq('teacher_id', user.id)` (student_profilesì—ì„œ) | `.eq('planner_id', user.id)` |
| `.eq('user_id', user.id)` (student_profilesì—ì„œ) | `.eq('id', user.id)` |
| `student.name` | `student.full_name` |
| `student.user_id` | `student.id` |

### Expo ê°œë°œ í™˜ê²½ ëª…ë ¹ì–´

```bash
# âŒ ì •ì  ì„œë²„ (HMR ì—†ìŒ)
npm start
npx serve web-build -l 10001

# âœ… ê°œë°œ ì„œë²„ (HMR ì§€ì›)
npx expo start --web --port 10001
```

### Playwright MCP ë©€í‹°íƒ­ í…ŒìŠ¤íŠ¸ íŒ

```javascript
// íƒ­ 0: í”Œë˜ë„ˆ ì•±
await browser_navigate({ url: 'http://localhost:3000' });

// íƒ­ 1: í•™ìƒ ì•± (ìƒˆ íƒ­ ìƒì„±)
await browser_tabs({ action: 'new' });
await browser_navigate({ url: 'http://localhost:10001' });

// íƒ­ ì „í™˜
await browser_tabs({ action: 'switch', index: 0 });  // í”Œë˜ë„ˆ ì•±
await browser_tabs({ action: 'switch', index: 1 });  // í•™ìƒ ì•±

// âš ï¸ ì£¼ì˜: íƒ­ì„ ë‹«ì§€ ë§ê³  ì¬ì‚¬ìš©í•  ê²ƒ
```

### ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

**ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì§€ ì•Šì„ ë•Œ**:
1. ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ Supabase ì—ëŸ¬ í™•ì¸
2. í…Œì´ë¸”ëª…ì´ `student_profiles`ì¸ì§€ í™•ì¸
3. ì»¬ëŸ¼ëª…ì´ `full_name`, `planner_id`ì¸ì§€ í™•ì¸
4. `conversations` í…Œì´ë¸”ì—ì„œ `teacher_id` ì‚¬ìš© í™•ì¸

**í•™ìƒ ì •ë³´ê°€ nullì¼ ë•Œ**:
1. `student_profiles` í…Œì´ë¸”ì— í–‰ì´ ìˆëŠ”ì§€ í™•ì¸
2. `planner_id`ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
3. Student interfaceì—ì„œ optional ì†ì„±(`?`) ì‚¬ìš© í™•ì¸

**ë‚ ì§œ ì„ íƒì´ ì•ˆ ë  ë•Œ**:
1. `<input type="date">` íƒœê·¸ì— `min` ì†ì„± ì œê±°
2. ê³¼ê±° ë‚ ì§œ ì…ë ¥ì´ í•„ìš”í•œ ê²½ìš° ì œì•½ ì¡°ê±´ ì œê±°

---

**ë¬¸ì„œ ë²„ì „**: 1.0
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026ë…„ 2ì›” 3ì¼ 19:00
